{% extends "base.html" %}

{% load static %}
{% block title%}
{{free_post.title}} | DeThatBit
{% endblock %}
{% block extra_head %}
<link rel="stylesheet" href="{% static 'free_board/free_board.css' %}" media="screen" />
{% endblock %}

{% block contents%}
<div class="content">
    <h1><a href="/free/">FreeBoard</a></h1>
    <div class="contentBox">
        <div class="contentBox_header">
            <div class="updateBtns">
                <button><a href="/free/{{free_post.pk}}/update/">Modify</a></button>
                <button onclick="alert_del()"><a href="/free/{{free_post.pk}}/delete/">Delete</a></button>
            </div>
            <h2>{{free_post.title}}</h2>
            <h5>{{free_post.author.username}}</h5>

        </div>
        <div class="contentBox_body">
            <p>{{free_post.get_content_markdown|safe}}</p>
        </div>
    </div>
</div>


<div class="cooment_form">
    <form action="/free/{{free_post.pk}}/comment_create/" method="POST">
        {% csrf_token %}
        {{comment_form}}
        <button class="btn btn-info mt-3" type="submit"> Submit </button>
    </form>
</div>

<div class="comment">
    {% if free_post.free_comment_set.count > 0 %}
        {% for comment in free_post.free_comment_set.all %}
        <div id="comment-{{comment.pk}}">
            {{ comment.writer }}
            <p>{{ comment.text | linebreaks }}</p>
            <small>{{ comment.created_at }}</small>
            <button><a href="/free/{{free_post.pk}}/comment_update/">Modify</a></button>
            <button onclick="alert_del()"><a href="/free/{{free_post.pk}}/comment_delete/">Delete</a></button>
            <hr>
        </div>
        {% endfor%}
    {% else %}
    <h1>댓글 없음</h1>
    {% endif %}
</div>


<script>
    function alert_del() {
        alert("삭제하시겠습니까?");
    }
    function isAuthor() {
        if ("{{free_post.author.id}}" != "{{user.id}}") {
            const btns = document.querySelector(".updateBtns");
            btns.classList.add("hidden");
        }
    }
    isAuthor();
</script>
{% endblock %}
